#!/bin/bash

docker-compose -f alfred-docker-compose.yml up -d

echo "Preparing refinery..."

MINIO_ENDPOINT=$(curl -X GET -s 'http://localhost:7066/start')
while [ $? -ne 0 ]
do
    MINIO_ENDPOINT=$(curl -X GET -s 'http://localhost:7066/start')
done

if [ $? -ne 0 ]; then
    echo "Preparations failed."
    exit 1
fi

echo "Preparations finsihed. Starting refinery..."

docker-compose -f refinery/docker-compose.yml up -d 

sleep 5

echo "UI:           http://localhost:4455/app/"
echo "Minio:        $MINIO_ENDPOINT"
echo "MailHog:      http://localhost:4436/"